<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF to JPG - PDFMitra</title>
  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <style>
    .pdf-jpg-container {
      max-width: 1000px;
      margin: 60px auto;
      padding: 0 20px;
      text-align: center;
    }

    .tool-card {
      background: #fff;
      padding: 40px;
      border-radius: 24px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    .tool-card h1 {
      font-size: 32px;
      margin-bottom: 10px;
    }

    .tool-card p {
      color: var(--text-light);
      margin-bottom: 30px;
    }

    .upload-box {
      border: 2px dashed var(--primary);
      padding: 24px;
      border-radius: 16px;
      cursor: pointer;
      display: inline-block;
      transition: all 0.3s;
    }

    .upload-box:hover {
      background: #f0f9f8;
    }

    .upload-box span {
      color: var(--primary);
      font-weight: 700;
    }

    #pdfToJpgFile {
      display: none;
    }

    .tool-btn {
      margin-top: 15px;
      padding: 14px 30px;
      border: none;
      border-radius: 50px;
      background: var(--primary);
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      font-weight: 600;
    }

    .tool-btn.orange {
      background: var(--accent);
      box-shadow: 0 10px 20px rgba(251, 140, 0, 0.2);
    }

    .tool-btn.gray {
      background: #9ca3af;
    }

    .preview {
      margin-top: 40px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
    }

    .img-card {
      background: #fff;
      border-radius: 14px;
      padding: 12px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    .img-card img {
      width: 100%;
      border-radius: 10px;
      background: #f9f9f9;
    }

    .img-card label {
      font-size: 13px;
      display: block;
      margin: 10px 0 5px;
    }

    .img-card a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 700;
      font-size: 13px;
    }
  </style>
</head>

<body>
  <div class="pdf-jpg-container">
    <div class="tool-card">
      <h1>PDF to JPG</h1>
      <p>Convert PDF pages into high-resolution JPG images instantly.</p>
      <label class="upload-box" for="pdfToJpgFile">
        <input type="file" id="pdfToJpgFile" accept="application/pdf" onchange="showPdfToJpgName(this)">
        <span><i class="fas fa-file-pdf"></i> Choose PDF File</span>
      </label>
      <div id="pdfToJpgFileNameDisplay" style="margin-top: 15px; font-weight: 600; color: var(--primary);"></div>
      <div style="margin-top:20px; display: flex; justify-content: center; gap: 15px;">
        <button class="tool-btn" onclick="convertPdfToJpg()">Convert All Pages</button>
        <button class="tool-btn gray" onclick="resetPdfToJpg()">Clear</button>
      </div>
      <div id="pdfToJpgLoading" style="display: none; margin-top: 20px; font-weight: 700; color: var(--primary);">⏳
        Converting…</div>
      <div style="margin-top:25px;">
        <button class="tool-btn orange" onclick="downloadSelectedJpgs()">Download Selected (ZIP)</button>
      </div>
    </div>
    <div class="preview" id="pdfToJpgPreview"></div>
  </div>

  <script src="js/ui-core.js"></script>
  <script>
    (function () {
      pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
      let images = [];
      window.showPdfToJpgName = function (input) {
        const f = input.files[0]; if (f) document.getElementById("pdfToJpgFileNameDisplay").innerText = "Selected: " + f.name;
      }
      window.convertPdfToJpg = async function () {
        const input = document.getElementById("pdfToJpgFile"); if (!input.files.length) { alert("Select PDF"); return; }
        const preview = document.getElementById("pdfToJpgPreview"); const loading = document.getElementById("pdfToJpgLoading");
        images = []; preview.innerHTML = ""; loading.style.display = "block";
        try {
          const pdf = await pdfjsLib.getDocument({ data: await input.files[0].arrayBuffer() }).promise;
          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i); const vp = page.getViewport({ scale: 2 });
            const c = document.createElement("canvas"); const ctx = c.getContext("2d");
            c.width = vp.width; c.height = vp.height; await page.render({ canvasContext: ctx, viewport: vp }).promise;
            const data = c.toDataURL("image/jpeg", 0.9); images.push(data);
            preview.innerHTML += `<div class="img-card"><img src="${data}"><label><input type="checkbox" data-index="${i - 1}"> Select</label><a href="${data}" download="page-${i}.jpg">⬇ Download JPG</a></div>`;
          }
        } catch (err) { alert("Error: " + err.message); }
        loading.style.display = "none";
      }
      window.downloadSelectedJpgs = function () {
        const checked = document.querySelectorAll("#pdfToJpgPreview input[type=checkbox]:checked");
        if (checked.length === 0) { alert("Select images"); return; }
        const zip = new JSZip();
        checked.forEach(c => { const i = c.dataset.index; zip.file(`page-${Number(i) + 1}.jpg`, images[i].split(",")[1], { base64: true }); });
        zip.generateAsync({ type: "blob" }).then(b => {
          const a = document.createElement("a"); a.href = URL.createObjectURL(b); a.download = "PDFMitra-JPGs.zip"; a.click();
        });
      }
      window.resetPdfToJpg = function () {
        document.getElementById("pdfToJpgFile").value = ""; document.getElementById("pdfToJpgFileNameDisplay").innerText = "";
        document.getElementById("pdfToJpgPreview").innerHTML = ""; images = [];
      }
    })();
  </script>
</body>

</html>